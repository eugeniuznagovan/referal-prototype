import{$ as oe,A as B,B as D,C as j,D as H,E as $,F as Y,I as q,J as z,K as R,M as G,O as J,P as K,Q as X,W as Z,X as ee,Y as te,Z as ne,_ as ie,a as b,aa as re,b as U,ba as ae,c as m,ca as se,d as _,da as le,e as S,ea as ce,f as T,fa as me,g as A,ga as pe,h as a,ha as E,i as F,ia as de,j as f,ja as ue,k as L,ka as ge,l,la as fe,m as P,ma as Ce,n as Q,na as u,o as W,p as i,q as t,r as p,s as x,t as I,u as C,v as N,w as r,x as w,y as O,z as V}from"./chunk-SBSR5UJA.js";import"./chunk-SRUD5PB2.js";import"./chunk-YWO3IHIW.js";import"./chunk-SD5XCXOE.js";import"./chunk-JV7ON635.js";import"./chunk-F7XBNY6P.js";import"./chunk-EXRUNRTN.js";import"./chunk-C4TORFO5.js";import"./chunk-UHUGRIBZ.js";import"./chunk-4WFVMWDK.js";import"./chunk-4I6HJA6T.js";import"./chunk-NMYJD6OP.js";import"./chunk-B43CU5JX.js";import"./chunk-TQEIIVVC.js";import"./chunk-LF5XB4YN.js";import{a as h,b as y}from"./chunk-NWJ5J3BN.js";function be(n,o){n&1&&(i(0,"p"),r(1,"Loading..."),t())}function _e(n,o){if(n&1&&(i(0,"div",0),D(1),i(2,"div",1)(3,"div",2),p(4,"ion-icon",3)(5,"ion-icon",3),t(),p(6,"ion-icon",3)(7,"ion-icon",3)(8,"ion-icon",3),t(),i(9,"div",4),p(10,"ion-icon",3)(11,"ion-icon",3),t()()),n&2){let e=C().referralCount();a(4),l("ngClass",e>=1?"green":"gray"),a(),l("ngClass",e>=2?"green":"gray"),a(),l("ngClass",e>=3?"green":"gray"),a(),l("ngClass",e>=4?"green":"gray"),a(),l("ngClass",e>=5?"green":"gray"),a(2),l("ngClass",e>=6?"green":"gray"),a(),l("ngClass",e>=7?"green":"gray")}}var v=class n{referralCount=T(void 0);static \u0275fac=function(e){return new(e||n)};static \u0275cmp=f({type:n,selectors:[["app-invite-status"]],inputs:{referralCount:[1,"referralCount"]},decls:2,vars:1,consts:[[1,"circle","circle-third"],[1,"circle","circle-second"],[1,"circle","circle-first"],["name","person-circle",3,"ngClass"],[2,"display","flex","align-items","center","padding-right","3px"]],template:function(e,s){e&1&&L(0,be,2,0,"p")(1,_e,12,7,"div",0),e&2&&P(s.referralCount()?1:0)},dependencies:[ce,$],styles:["ion-icon[_ngcontent-%COMP%]{border-radius:10px}ion-icon.green[_ngcontent-%COMP%]{background:var(--ion-color-strong-green);color:var(--ion-color-light-green)}ion-icon.gray[_ngcontent-%COMP%]{background:var(--ion-color-light);color:var(--ion-color-normal-gray)}.circle[_ngcontent-%COMP%]{display:flex;padding:3px;border-radius:12px;align-items:center;margin-right:2px}.circle-third[_ngcontent-%COMP%]{background:var(--ion-color-strong-blue)}.circle-second[_ngcontent-%COMP%]{background:var(--ion-color-normal-blue)}.circle-first[_ngcontent-%COMP%]{background:var(--ion-color-light-blue)}"]})};var k={apiUrl:"https://55e3-82-102-46-12.ngrok-free.app"};var g=class n{#e=m(Y);async getInvitedUsers(o){return b(this.#e.get(`${k.apiUrl}/invites/${o}`))}async inviteUser(o){return b(this.#e.post(`${k.apiUrl}/addUser`,o))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})};var Se={loading:!0,error:void 0,contacts:[]},M=de(fe(Se),ge((n,o=m(u),e=m(g),s=m(Ce))=>({async inviteUser(){let c=o.user();if(!c)throw new Error("Missing telegram user");s.openInviteLink(c)}})),ue({async onInit(n,o=m(u),e=m(g)){let s=o.user()?.id;if(!s)throw new Error("Missing telegram user");try{let c=await e.getInvitedUsers(s);E(n,d=>y(h({},d),{contacts:c}))}catch{E(n,d=>y(h({},d),{error:"Failed to fetch invited users"}))}}}));var xe=(n,o)=>o.username;function Ie(n,o){if(n&1){let e=x();i(0,"ion-item",10,0),I("click",function(){_(e);let c=N(11);return S(c.checked=!c.checked)}),i(2,"ion-avatar"),p(3,"img",11),t(),i(4,"ion-label",12)(5,"h3"),r(6),t(),i(7,"p"),r(8),t()(),p(9,"app-invite-status",13)(10,"ion-checkbox",5,1),t()}if(n&2){let e=o.$implicit;a(3),l("src",e.photo_url,A),a(3),w(e.first_name),a(2),w(e.username),a(),l("referralCount",2)}}function we(n,o){if(n&1){let e=x();i(0,"ion-item")(1,"ion-label"),r(2,"No results found."),t(),i(3,"ion-button",14),I("click",function(){_(e);let c=C();return S(c.store.inviteUser())}),r(4,"Invite"),t()()}}var he=class n{store=m(M);appStore=m(u);searchQuery=F("");filteredContacts=H(()=>{let o=this.searchQuery().toLowerCase();return this.store.contacts().filter(e=>e.first_name.toLowerCase().includes(o)||e?.last_name?.toLowerCase().includes(o)||e?.username?.toLowerCase().includes(o))});static \u0275fac=function(e){return new(e||n)};static \u0275cmp=f({type:n,selectors:[["app-contacts"]],inputs:{searchQuery:[1,"searchQuery"]},outputs:{searchQuery:"searchQueryChange"},features:[j([M])],decls:41,vars:3,consts:[["item",""],["checkbox",""],[3,"color"],["slot","start"],["defaultHref","home"],["slot","end"],["value","default"],["value","segment"],["placeholder","Search Users",3,"ngModelChange","ngModel"],["detail","false","button",""],["detail","false","button","",3,"click"],["alt","User Avatar",3,"src"],[2,"margin-left","1rem","text-overflow","elipsis","overflow","hidden","white-space","nowrap"],[2,"margin-right","1rem",3,"referralCount"],["slot","end",3,"click"]],template:function(e,s){e&1&&(i(0,"ion-header")(1,"ion-toolbar",2)(2,"ion-buttons",3),p(3,"ion-back-button",4),t(),i(4,"ion-title"),r(5,"Contacts"),t()(),i(6,"ion-toolbar")(7,"ion-list")(8,"ion-item")(9,"ion-label"),r(10,"Your Contacts are your resources"),t(),i(11,"ion-label",5),r(12,"9"),t()(),i(13,"ion-item")(14,"ion-label"),r(15,"Your Contacts are your resources"),t(),i(16,"ion-label",5),r(17,"5"),t()(),i(18,"ion-item")(19,"ion-label"),r(20,"Already Recommended"),t(),i(21,"ion-label",5),r(22,"2"),t()()()(),i(23,"ion-toolbar")(24,"ion-segment",6)(25,"ion-segment-button",6)(26,"ion-label"),r(27,"All Friends"),t()(),i(28,"ion-segment-button",7)(29,"ion-label"),r(30,"Select"),t()()()(),i(31,"ion-toolbar")(32,"ion-searchbar",8),B("ngModelChange",function(d){return V(s.searchQuery,d)||(s.searchQuery=d),d}),t()()(),i(33,"ion-content")(34,"ion-list")(35,"ion-list-header")(36,"ion-label"),r(37,"Friends list"),t()(),Q(38,Ie,12,4,"ion-item",9,xe,!1,we,5,0,"ion-item"),t()()),e&2&&(a(),l("color",s.appStore.isLightTheme()?"primary":""),a(31),O("ngModel",s.searchQuery),a(6),W(s.filteredContacts()))},dependencies:[ee,se,ae,Z,X,G,pe,re,ne,me,ie,oe,te,J,le,R,q,z,v,K],styles:["ion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}"]})};export{he as ContactsComponent};

import{$ as ae,A as H,B as V,C as R,D as Y,E as Z,F as $,G,H as K,K as q,L as z,M as J,O as X,Q as ee,R as te,S as ne,Y as ie,Z as oe,_ as re,a as S,aa as se,b as C,ba as ce,c as l,ca as le,d as I,da as de,e as k,ea as pe,f as A,fa as me,g as F,ga as ue,h as s,ha as fe,i as y,ia as ge,j as P,ja as Ce,k as h,ka as T,l as L,la as ye,m as d,ma as he,n as N,na as _e,o as j,oa as ve,p as B,pa as be,q as r,qa as f,r as o,s as m,t as w,u as _,v as u,w as Q,x as c,y as E,z as W}from"./chunk-ZOVSQMZC.js";import"./chunk-SRUD5PB2.js";import"./chunk-YWO3IHIW.js";import"./chunk-SD5XCXOE.js";import"./chunk-JV7ON635.js";import"./chunk-F7XBNY6P.js";import"./chunk-EXRUNRTN.js";import"./chunk-C4TORFO5.js";import"./chunk-UHUGRIBZ.js";import"./chunk-4WFVMWDK.js";import"./chunk-4I6HJA6T.js";import"./chunk-NMYJD6OP.js";import"./chunk-B43CU5JX.js";import"./chunk-TQEIIVVC.js";import"./chunk-LF5XB4YN.js";import{a as b,b as x}from"./chunk-NWJ5J3BN.js";function we(n,t){n&1&&(r(0,"p"),c(1,"Loading..."),o())}function Ee(n,t){if(n&1&&(r(0,"div",0),R(1),r(2,"div",1)(3,"div",2),m(4,"ion-icon",3)(5,"ion-icon",3),o(),m(6,"ion-icon",3)(7,"ion-icon",3)(8,"ion-icon",3),o(),r(9,"div",4),m(10,"ion-icon",3)(11,"ion-icon",3),o()()),n&2){let e=u().referralCount();s(4),d("ngClass",e>=1?"green":"gray"),s(),d("ngClass",e>=2?"green":"gray"),s(),d("ngClass",e>=3?"green":"gray"),s(),d("ngClass",e>=4?"green":"gray"),s(),d("ngClass",e>=5?"green":"gray"),s(2),d("ngClass",e>=6?"green":"gray"),s(),d("ngClass",e>=7?"green":"gray")}}var v=class n{referralCount=A(void 0);static \u0275fac=function(e){return new(e||n)};static \u0275cmp=h({type:n,selectors:[["app-invite-status"]],inputs:{referralCount:[1,"referralCount"]},decls:2,vars:1,consts:[[1,"circle","circle-third"],[1,"circle","circle-second"],[1,"circle","circle-first"],["name","person-circle",3,"ngClass"],[2,"display","flex","align-items","center","padding-right","3px"]],template:function(e,i){e&1&&L(0,we,2,0,"p")(1,Ee,12,7,"div",0),e&2&&N(i.referralCount()?1:0)},dependencies:[fe,G],styles:["ion-icon[_ngcontent-%COMP%]{border-radius:10px}ion-icon.green[_ngcontent-%COMP%]{background:var(--ion-color-strong-green);color:var(--ion-color-light-green)}ion-icon.gray[_ngcontent-%COMP%]{background:var(--ion-color-light);color:var(--ion-color-normal-gray)}.circle[_ngcontent-%COMP%]{display:flex;padding:3px;border-radius:12px;align-items:center;margin-right:2px}.circle-third[_ngcontent-%COMP%]{background:var(--ion-color-strong-blue)}.circle-second[_ngcontent-%COMP%]{background:var(--ion-color-normal-blue)}.circle-first[_ngcontent-%COMP%]{background:var(--ion-color-light-blue)}"]})};var O={apiUrl:"https://55e3-82-102-46-12.ngrok-free.app"};var g=class n{#e=l(K);loading=y(!1);error=y(void 0);data=y(void 0);async getInvitedUsers(t){return S(this.#e.get(`${O.apiUrl}/invites/${t}`))}async inviteUser(t){return S(this.#e.post(`${O.apiUrl}/addUser`,t))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=C({token:n,factory:n.\u0275fac,providedIn:"root"})};var D=class{_document;_textarea;constructor(t,e){this._document=e;let i=this._textarea=this._document.createElement("textarea"),a=i.style;a.position="fixed",a.top=a.opacity="0",a.left="-999em",i.setAttribute("aria-hidden","true"),i.value=t,i.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(i)}copy(){let t=this._textarea,e=!1;try{if(t){let i=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),e=this._document.execCommand("copy"),i&&i.focus()}}catch{}return e}destroy(){let t=this._textarea;t&&(t.remove(),this._textarea=void 0)}},xe=(()=>{class n{_document=l($);constructor(){}copy(e){let i=this.beginCopy(e),a=i.copy();return i.destroy(),a}beginCopy(e){return new D(e,this._document)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=C({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Te={loading:!0,error:void 0,contacts:[]},U=ye(ve(Te),_e((n,t=l(f),e=l(g),i=l(be),a=l(xe))=>({async inviteUser(){let p=t.user();if(!p)throw new Error("Missing telegram user");let Ie=i.getInviteLink(p);a.copy(Ie)}})),he({async onInit(n,t=l(f),e=l(g)){let i=t.user()?.id;if(!i)throw new Error("Missing telegram user");try{let a=await e.getInvitedUsers(i);T(n,p=>x(b({},p),{contacts:a}))}catch{T(n,p=>x(b({},p),{error:"Failed to fetch invited users"}))}}}));var Me=(n,t)=>t.username;function Oe(n,t){if(n&1){let e=w();r(0,"ion-item",10,0),_("click",function(){I(e);let a=Q(11);return k(a.checked=!a.checked)}),r(2,"ion-avatar"),m(3,"img",11),o(),r(4,"ion-label",12)(5,"h3"),c(6),o(),r(7,"p"),c(8),o()(),m(9,"app-invite-status",13)(10,"ion-checkbox",5,1),o()}if(n&2){let e=t.$implicit;s(3),d("src",e.photo_url,F),s(3),E(e.first_name),s(2),E(e.username),s(),d("referralCount",2)}}function De(n,t){if(n&1){let e=w();r(0,"ion-item")(1,"ion-label"),c(2,"No results found."),o(),r(3,"ion-button",14),_("click",function(){I(e);let a=u();return k(a.store.inviteUser())}),c(4,"Invite"),o(),m(5,"ion-toast",15),o()}if(n&2){let e,i=u();s(5),d("message","Invite Copied: "+((e=i.appStore.user())==null?null:e.id))("duration",5e3)}}var Se=class n{store=l(U);appStore=l(f);searchQuery=P("");filteredContacts=Z(()=>{let t=this.searchQuery().toLowerCase();return this.store.contacts().filter(e=>e.first_name.toLowerCase().includes(t)||e?.last_name?.toLowerCase().includes(t)||e?.username?.toLowerCase().includes(t))});static \u0275fac=function(e){return new(e||n)};static \u0275cmp=h({type:n,selectors:[["app-contacts"]],inputs:{searchQuery:[1,"searchQuery"]},outputs:{searchQuery:"searchQueryChange"},features:[Y([U])],decls:41,vars:3,consts:[["item",""],["checkbox",""],[3,"color"],["slot","start"],["defaultHref","home"],["slot","end"],["value","default"],["value","segment"],["placeholder","Search Users",3,"ngModelChange","ngModel"],["detail","false","button",""],["detail","false","button","",3,"click"],["alt","User Avatar",3,"src"],[2,"margin-left","1rem","text-overflow","elipsis","overflow","hidden","white-space","nowrap"],[2,"margin-right","1rem",3,"referralCount"],["id","open-toast","slot","end",3,"click"],["trigger","open-toast",3,"message","duration"]],template:function(e,i){e&1&&(r(0,"ion-header")(1,"ion-toolbar",2)(2,"ion-buttons",3),m(3,"ion-back-button",4),o(),r(4,"ion-title"),c(5,"Contacts"),o()(),r(6,"ion-toolbar")(7,"ion-list")(8,"ion-item")(9,"ion-label"),c(10,"Your Contacts are your resources"),o(),r(11,"ion-label",5),c(12,"9"),o()(),r(13,"ion-item")(14,"ion-label"),c(15,"Your Contacts are your resources"),o(),r(16,"ion-label",5),c(17,"5"),o()(),r(18,"ion-item")(19,"ion-label"),c(20,"Already Recommended"),o(),r(21,"ion-label",5),c(22,"2"),o()()()(),r(23,"ion-toolbar")(24,"ion-segment",6)(25,"ion-segment-button",6)(26,"ion-label"),c(27,"All Friends"),o()(),r(28,"ion-segment-button",7)(29,"ion-label"),c(30,"Select"),o()()()(),r(31,"ion-toolbar")(32,"ion-searchbar",8),V("ngModelChange",function(p){return H(i.searchQuery,p)||(i.searchQuery=p),p}),o()()(),r(33,"ion-content")(34,"ion-list")(35,"ion-list-header")(36,"ion-label"),c(37,"Friends list"),o()(),j(38,Oe,12,4,"ion-item",9,Me,!1,De,6,2,"ion-item"),o()()),e&2&&(s(),d("color",i.appStore.isLightTheme()?"primary":""),s(31),W("ngModel",i.searchQuery),s(6),B(i.filteredContacts()))},dependencies:[oe,me,de,ie,ne,X,Ce,le,ae,ge,se,ce,re,ee,ue,J,q,z,v,te,pe],styles:["ion-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}"]})};export{Se as ContactsComponent};
